<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìµëª… ê²Œì‹œíŒ</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #f5f7fa; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { text-align: center; padding: 20px; background: white; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; background: white; padding: 10px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .tab { flex: 1; padding: 12px; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; background: #f5f7fa; color: #7f8c8d; transition: all 0.3s; }
        .tab.active { background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%); color: white; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px; }
        input, textarea, select { width: 100%; padding: 12px; border: 2px solid #e8e8e8; border-radius: 8px; font-size: 1rem; margin-bottom: 10px; font-family: inherit; }
        textarea { min-height: 100px; resize: vertical; }
        .btn { width: 100%; padding: 14px; background: #4a90e2; color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .btn:hover { background: #357abd; transform: translateY(-2px); }
        .btn:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        .btn-small { width: auto; padding: 8px 15px; font-size: 0.9rem; }
        .post { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 15px; }
        .post-header { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; color: #666; }
        .post-footer { display: flex; gap: 10px; margin-top: 15px; padding-top: 15px; border-top: 1px solid #f0f0f0; }
        .reaction { padding: 8px 12px; background: #f8f9fa; border: 1px solid #e8e8e8; border-radius: 20px; cursor: pointer; font-size: 0.9rem; transition: all 0.3s; }
        .reaction:hover { background: #e8ecef; transform: scale(1.05); }
        .comments { background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; }
        .comment { background: white; padding: 12px; border-radius: 8px; margin-bottom: 10px; }
        .comment-header { font-size: 0.85rem; color: #666; margin-bottom: 5px; }
        .comment-input { display: flex; gap: 10px; margin-top: 10px; }
        .iframe-container { width: 100%; height: 80vh; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .iframe-container iframe { width: 100%; height: 100%; border: none; }
        .dcinside-info { background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ffc107; }
        
        /* ì›€ì§ì´ëŠ” ê°ì‚¬ ë©”ì‹œì§€ */
        .floating-message {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            writing-mode: vertical-rl;
            font-size: 1.2rem;
            font-weight: bold;
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%, #ff6b9d 200%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: float 3s ease-in-out infinite, gradient 5s ease infinite;
            z-index: 1000;
            pointer-events: none;
            text-shadow: 0 0 10px rgba(255,107,157,0.3);
            background-size: 200% 200%;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(-50%) translateX(0); }
            50% { transform: translateY(-50%) translateX(10px); }
        }
        
        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @media (max-width: 768px) {
            .floating-message { display: none; }
        }
        
        /* ê±°ì§“ë§ íƒì§€ê¸° ìŠ¤íƒ€ì¼ */
        .detector-container {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .detector-loading {
            text-align: center;
            padding: 60px 20px;
        }
        
        .heartbeat {
            font-size: 4rem;
            animation: heartbeat 1s ease-in-out infinite;
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }
        
        .detector-result {
            text-align: center;
            padding: 40px;
            border-radius: 20px;
            margin-top: 30px;
            animation: resultAppear 0.5s ease-out;
        }
        
        .detector-result.truth {
            background: linear-gradient(135deg, #4caf50 0%, #81c784 100%);
            border: 5px solid #2e7d32;
        }
        
        .detector-result.lie {
            background: linear-gradient(135deg, #f44336 0%, #e57373 100%);
            border: 5px solid #c62828;
        }
        
        .detector-result.error {
            background: linear-gradient(135deg, #9e9e9e 0%, #bdbdbd 100%);
            border: 5px solid #616161;
        }
        
        .verdict {
            font-size: 4rem;
            font-weight: bold;
            color: white;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            animation: verdictShake 0.5s ease-out;
        }
        
        .reason {
            font-size: 1.3rem;
            color: white;
            font-weight: 600;
            line-height: 1.6;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        @keyframes resultAppear {
            0% {
                opacity: 0;
                transform: scale(0.5) rotate(-10deg);
            }
            60% {
                transform: scale(1.1) rotate(2deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0);
            }
        }
        
        @keyframes verdictShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }
        
        .screen-shake {
            animation: screenShake 0.5s ease-out;
        }
        
        @keyframes screenShake {
            0%, 100% { transform: translate(0, 0); }
            10%, 30%, 50%, 70%, 90% { transform: translate(-5px, -5px); }
            20%, 40%, 60%, 80% { transform: translate(5px, 5px); }
        }
        
        .screen-flash {
            animation: screenFlash 0.5s ease-out;
        }
        
        @keyframes screenFlash {
            0%, 100% { background: #f5f7fa; }
            50% { background: #ffffff; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const firebaseConfig = {
            apiKey: "AIzaSyDh3FsyWVZqy8wGExv-IlAglJ0DERuW_T8",
            authDomain: "ccccc-74256.firebaseapp.com",
            databaseURL: "https://ccccc-74256-default-rtdb.firebaseio.com",
            projectId: "ccccc-74256"
        };
        
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        
        function App() {
            const [tab, setTab] = useState('board');
            const [posts, setPosts] = useState([]);
            const [nickname, setNickname] = useState('');
            const [content, setContent] = useState('');
            const [loading, setLoading] = useState(true);
            const [openComments, setOpenComments] = useState({});
            const [commentInputs, setCommentInputs] = useState({});
            const [commentNicknames, setCommentNicknames] = useState({});
            
            // ì±„íŒ… ê´€ë ¨ state
            const [chatMessages, setChatMessages] = useState([]);
            const [chatInput, setChatInput] = useState('');
            const [chatLoading, setChatLoading] = useState(true);
            const chatEndRef = React.useRef(null);
            
            // ê±°ì§“ë§ íƒì§€ê¸° state
            const [detectorQuestion, setDetectorQuestion] = useState('');
            const [detectorResult, setDetectorResult] = useState(null);
            const [detectorLoading, setDetectorLoading] = useState(false);
            const [showImpact, setShowImpact] = useState(false);
            
            // ëœë¤ ë‹‰ë„¤ì„ ìë™ ë°°ì •
            const getRandomNickname = () => {
                let savedName = localStorage.getItem('chatRandomNickname');
                if (!savedName) {
                    const names = ['ì„ì›…', 'ëª…ì§„', 'ë¯¼ìˆ˜', 'ì¶©ì—°', 'ë¯¼ê¸°', 'ë¯¼í˜¸', 'ì‹ ìš°', 'ëŒ€ì›…'];
                    savedName = names[Math.floor(Math.random() * names.length)];
                    localStorage.setItem('chatRandomNickname', savedName);
                }
                return savedName;
            };
            
            useEffect(() => {
                const ref = db.ref('posts');
                ref.on('value', (snap) => {
                    const data = snap.val();
                    if (data) {
                        const arr = Object.keys(data).map(k => ({id: k, ...data[k]})).sort((a,b) => b.timestamp - a.timestamp);
                        setPosts(arr);
                    }
                    setLoading(false);
                });
                return () => ref.off();
            }, []);
            
            // ì±„íŒ… ë©”ì‹œì§€ ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ
            useEffect(() => {
                const chatRef = db.ref('chatMessages').limitToLast(100);
                chatRef.on('value', (snap) => {
                    const data = snap.val();
                    if (data) {
                        const arr = Object.keys(data).map(k => ({id: k, ...data[k]})).sort((a,b) => a.timestamp - b.timestamp);
                        setChatMessages(arr);
                    } else {
                        setChatMessages([]);
                    }
                    setChatLoading(false);
                });
                return () => chatRef.off();
            }, []);
            
            // ì±„íŒ… ìë™ ìŠ¤í¬ë¡¤
            useEffect(() => {
                if (chatEndRef.current && tab === 'chat') {
                    chatEndRef.current.scrollIntoView({ behavior: 'smooth' });
                }
            }, [chatMessages, tab]);
            
            const submit = () => {
                if (!content.trim()) return;
                db.ref('posts').push({ 
                    nickname: nickname.trim() || 'ìµëª…',
                    content: content.trim(), 
                    timestamp: Date.now(), 
                    reactions: {hug:0,cheer:0}, 
                    comments: {} 
                });
                setNickname('');
                setContent('');
            };
            
            const react = (id, type) => {
                const post = posts.find(p => p.id === id);
                db.ref(`posts/${id}/reactions/${type}`).set((post.reactions?.[type] || 0) + 1);
            };
            
            const toggleComments = (id) => {
                setOpenComments({...openComments, [id]: !openComments[id]});
            };
            
            const addComment = (postId) => {
                const text = commentInputs[postId];
                if (!text?.trim()) return;
                
                // localStorageì—ì„œ ì´ ê²Œì‹œê¸€ì— ëŒ€í•œ ë‚´ ìµëª… ë²ˆí˜¸ ê°€ì ¸ì˜¤ê¸°
                const myAnonymousIds = JSON.parse(localStorage.getItem('myAnonymousIds') || '{}');
                let myNumber = myAnonymousIds[postId];
                
                // ì´ ê²Œì‹œê¸€ì— ì²˜ìŒ ëŒ“ê¸€ ë‹¤ëŠ” ê²½ìš°
                if (!myNumber) {
                    // í˜„ì¬ ì´ ê²Œì‹œê¸€ì˜ ìµœëŒ€ ìµëª… ë²ˆí˜¸ ì°¾ê¸°
                    let maxNumber = 0;
                    if (posts.find(p => p.id === postId)?.nickname === 'ìµëª…') {
                        maxNumber = 1; // ê²Œì‹œê¸€ ì‘ì„±ìê°€ ìµëª…1
                    }
                    
                    // ê¸°ì¡´ ëŒ“ê¸€ë“¤ì—ì„œ ìµœëŒ€ ë²ˆí˜¸ ì°¾ê¸°
                    const post = posts.find(p => p.id === postId);
                    if (post?.comments) {
                        Object.values(post.comments).forEach(c => {
                            if (c.nickname?.startsWith('ìµëª…')) {
                                const num = parseInt(c.nickname.replace('ìµëª…', ''));
                                if (!isNaN(num) && num > maxNumber) {
                                    maxNumber = num;
                                }
                            }
                        });
                    }
                    
                    myNumber = maxNumber + 1;
                    myAnonymousIds[postId] = myNumber;
                    localStorage.setItem('myAnonymousIds', JSON.stringify(myAnonymousIds));
                }
                
                const nickname = commentNicknames[postId]?.trim() || `ìµëª…${myNumber}`;
                
                db.ref(`posts/${postId}/comments`).push({ 
                    nickname: nickname,
                    content: text.trim(), 
                    timestamp: Date.now() 
                });
                setCommentInputs({...commentInputs, [postId]: ''});
                setCommentNicknames({...commentNicknames, [postId]: ''});
            };
            
            // ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
            const sendChatMessage = () => {
                if (!chatInput.trim()) return;
                
                const nickname = getRandomNickname();
                
                db.ref('chatMessages').push({
                    nickname: nickname,
                    message: chatInput.trim(),
                    timestamp: Date.now()
                });
                
                setChatInput('');
            };
            
            // ê±°ì§“ë§ íƒì§€ í•¨ìˆ˜
            const detectLie = async () => {
                if (!detectorQuestion.trim()) return;
                
                setDetectorLoading(true);
                setDetectorResult(null);
                setShowImpact(false);
                
                try {
                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 1000,
                            messages: [{
                                role: 'user',
                                content: `ë‹¹ì‹ ì€ ëƒ‰ì •í•˜ê³  ì”í˜¹í•œ ê±°ì§“ë§ íƒì§€ê¸°ì…ë‹ˆë‹¤. ë‹¤ìŒ ì§ˆë¬¸ì´ë‚˜ ì§„ìˆ ì— ëŒ€í•´ ì§„ì‹¤ì¸ì§€ ê±°ì§“ì¸ì§€ íŒë‹¨í•˜ì„¸ìš”.

ì§ˆë¬¸/ì§„ìˆ : "${detectorQuestion}"

ë§¤ìš° ëƒ‰ì •í•˜ê³  ì§ì„¤ì ìœ¼ë¡œ íŒë‹¨í•˜ì„¸ìš”. ê°ì •ì„ ë°°ì œí•˜ê³  ë…¼ë¦¬ì™€ ìƒì‹ì— ê¸°ë°˜í•˜ì—¬ íŒë‹¨í•˜ì„¸ìš”.

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œë§Œ ë‹µë³€í•˜ì„¸ìš”:
íŒì •: [ì§„ì‹¤/ê±°ì§“]
ì´ìœ : [í•œ ë¬¸ì¥ìœ¼ë¡œ ëƒ‰ì •í•˜ê²Œ ì„¤ëª…]

ì˜ˆì‹œ:
íŒì •: ê±°ì§“
ì´ìœ : ì¸ê°„ì˜ ë‡ŒëŠ” 10%ë§Œ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì€ ê³¼í•™ì ìœ¼ë¡œ ì…ì¦ëœ ê±°ì§“ì´ë©°, ì „ì²´ ë‡Œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.`
                            }]
                        })
                    });
                    
                    const data = await response.json();
                    const text = data.content[0].text;
                    
                    // íŒì •ê³¼ ì´ìœ  íŒŒì‹±
                    const verdictMatch = text.match(/íŒì •:\s*(ì§„ì‹¤|ê±°ì§“)/);
                    const reasonMatch = text.match(/ì´ìœ :\s*(.+)/);
                    
                    const verdict = verdictMatch ? verdictMatch[1] : 'íŒì • ë¶ˆê°€';
                    const reason = reasonMatch ? reasonMatch[1].trim() : 'íŒë‹¨í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    
                    // ë¡œë”© ì‹œê°„ ì—°ì¶œ (ê¸´ì¥ê°)
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    setDetectorResult({ verdict, reason });
                    setShowImpact(true);
                    
                    // ì„íŒ©íŠ¸ íš¨ê³¼ í›„ ì œê±°
                    setTimeout(() => setShowImpact(false), 500);
                    
                } catch (error) {
                    console.error('ê±°ì§“ë§ íƒì§€ ì˜¤ë¥˜:', error);
                    setDetectorResult({ 
                        verdict: 'ì˜¤ë¥˜', 
                        reason: 'íƒì§€ ì‹œìŠ¤í…œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' 
                    });
                }
                
                setDetectorLoading(false);
            };
            
            return (
                <div className="container">
                    <div className="header">
                        <h1>ğŸ“‹ ìµëª… ê²Œì‹œíŒ</h1>
                    </div>
                    
                    <div className="tabs">
                        <button className={`tab ${tab==='board'?'active':''}`} onClick={()=>setTab('board')}>ğŸ“ ê²Œì‹œíŒ</button>
                        <button className={`tab ${tab==='chat'?'active':''}`} onClick={()=>setTab('chat')}>ğŸ’¬ ì±„íŒ…</button>
                        <button className={`tab ${tab==='detector'?'active':''}`} onClick={()=>setTab('detector')}>ğŸ” ê±°ì§“ë§íƒì§€ê¸°</button>
                        <button className={`tab ${tab==='ygosu'?'active':''}`} onClick={()=>setTab('ygosu')}>ğŸ® ì™€ì´ê³ ìˆ˜</button>
                        <button className={`tab ${tab==='fmkorea'?'active':''}`} onClick={()=>setTab('fmkorea')}>âš½ í¨ì½”</button>
                        <button className={`tab ${tab==='guardian'?'active':''}`} onClick={()=>setTab('guardian')}>ğŸ“° ê°€ë””ì–¸</button>
                    </div>
                    
                    {tab === 'board' ? (
                        <>
                            <div className="card">
                                <h3>âœï¸ ê¸€ ì‘ì„±</h3>
                                <input 
                                    type="text"
                                    value={nickname} 
                                    onChange={e=>setNickname(e.target.value)} 
                                    placeholder="ë‹‰ë„¤ì„ (ì„ íƒ, ë¹„ìš°ë©´ 'ìµëª…')" 
                                    maxLength={20}
                                    style={{marginBottom:'10px'}}
                                />
                                <textarea value={content} onChange={e=>setContent(e.target.value)} placeholder="ë‚´ìš© ì…ë ¥..." maxLength={500} />
                                <div style={{textAlign:'right',fontSize:'0.9rem',color:'#666',marginBottom:'10px'}}>{content.length}/500</div>
                                <button className="btn" onClick={submit} disabled={!content.trim()}>ê²Œì‹œí•˜ê¸°</button>
                            </div>
                            <h3 style={{marginBottom:'15px'}}>ğŸ“ ê²Œì‹œê¸€ ({posts.length})</h3>
                            {loading ? <div className="card">ë¡œë”©ì¤‘...</div> : posts.length === 0 ? <div className="card">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div> : posts.map(p => {
                                const getAnonymousNumber = () => {
                                    if (p.nickname === 'ìµëª…') return 'ìµëª…1';
                                    return p.nickname || 'ìµëª…1';
                                };
                                
                                return (
                                <div key={p.id} className="post">
                                    <div className="post-header">
                                        <strong>{getAnonymousNumber()}</strong>
                                        <span>{new Date(p.timestamp).toLocaleString('ko-KR')}</span>
                                    </div>
                                    <div style={{lineHeight:'1.6'}}>{p.content}</div>
                                    <div className="post-footer">
                                        <span className="reaction" onClick={()=>react(p.id,'hug')}>ğŸ¤— {p.reactions?.hug || 0}</span>
                                        <span className="reaction" onClick={()=>react(p.id,'cheer')}>ğŸ’ª {p.reactions?.cheer || 0}</span>
                                        <span className="reaction" onClick={()=>toggleComments(p.id)}>ğŸ’¬ ëŒ“ê¸€ {p.comments ? Object.keys(p.comments).length : 0}</span>
                                    </div>
                                    {openComments[p.id] && (
                                        <div className="comments">
                                            {p.comments && (() => {
                                                const anonymousCounter = { count: p.nickname === 'ìµëª…' ? 2 : 1 };
                                                
                                                return Object.keys(p.comments).map(cid => {
                                                    const c = p.comments[cid];
                                                    const isAuthor = c.nickname === p.nickname && c.nickname !== 'ìµëª…';
                                                    
                                                    let displayName = c.nickname || 'ìµëª…';
                                                    let showAuthorBadge = false;
                                                    
                                                    if (displayName === 'ìµëª…') {
                                                        if (p.nickname === 'ìµëª…') {
                                                            displayName = `ìµëª…${anonymousCounter.count}`;
                                                            anonymousCounter.count++;
                                                        } else {
                                                            displayName = `ìµëª…${anonymousCounter.count}`;
                                                            anonymousCounter.count++;
                                                        }
                                                    } else {
                                                        showAuthorBadge = isAuthor;
                                                    }
                                                    
                                                    return (
                                                        <div key={cid} className="comment">
                                                            <div className="comment-header">
                                                                <strong>{displayName}</strong>
                                                                {showAuthorBadge && (
                                                                    <span style={{
                                                                        marginLeft: '6px',
                                                                        padding: '2px 8px',
                                                                        background: 'linear-gradient(135deg, #4a90e2 0%, #357abd 100%)',
                                                                        color: 'white',
                                                                        borderRadius: '4px',
                                                                        fontSize: '0.75rem',
                                                                        fontWeight: 'bold'
                                                                    }}>
                                                                        ê¸€ì“´ì´
                                                                    </span>
                                                                )}
                                                                {' Â· '}{new Date(c.timestamp).toLocaleString('ko-KR')}
                                                            </div>
                                                            <div>{c.content}</div>
                                                        </div>
                                                    );
                                                });
                                            })()}
                                            <div style={{marginTop:'10px'}}>
                                                <input 
                                                    value={commentNicknames[p.id] || (() => {
                                                        const myIds = JSON.parse(localStorage.getItem('myAnonymousIds') || '{}');
                                                        return myIds[p.id] ? `ìµëª…${myIds[p.id]}` : '';
                                                    })()}
                                                    readOnly
                                                    placeholder={(() => {
                                                        const myIds = JSON.parse(localStorage.getItem('myAnonymousIds') || '{}');
                                                        return myIds[p.id] ? `ìµëª…${myIds[p.id]} (ìë™ë°°ì •)` : 'ìµëª… ë²ˆí˜¸ ìë™ë°°ì •';
                                                    })()}
                                                    maxLength={20}
                                                    style={{
                                                        marginBottom:'8px',
                                                        background: '#f8f9fa',
                                                        cursor: 'not-allowed',
                                                        color: '#495057'
                                                    }}
                                                />
                                                <div className="comment-input">
                                                    <input 
                                                        value={commentInputs[p.id] || ''} 
                                                        onChange={e=>setCommentInputs({...commentInputs, [p.id]: e.target.value})}
                                                        onKeyPress={e=>e.key==='Enter'&&addComment(p.id)}
                                                        placeholder="ëŒ“ê¸€ ì…ë ¥..."
                                                        style={{flex:1}}
                                                    />
                                                    <button className="btn btn-small" onClick={()=>addComment(p.id)}>ì‘ì„±</button>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                                );
                            })}
                        </>
                    ) : tab === 'chat' ? (
                        <div>
                            <div className="card" style={{
                                marginBottom:'20px',
                                textAlign:'center',
                                background:'linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)',
                                border:'2px solid #64b5f6'
                            }}>
                                <h3 style={{marginBottom:'10px'}}>ğŸ’¬ ì‹¤ì‹œê°„ ì±„íŒ…</h3>
                                <p style={{fontSize:'1.1rem',fontWeight:'bold',color:'#1976d2'}}>
                                    ë‹¹ì‹ ì˜ ë‹‰ë„¤ì„: {getRandomNickname()} ğŸ²
                                </p>
                                <p style={{fontSize:'0.85rem',color:'#666',marginTop:'5px'}}>
                                    (ìë™ ë°°ì •, ë³€ê²½ ë¶ˆê°€)
                                </p>
                            </div>
                            
                            <div className="card" style={{
                                height:'500px',
                                display:'flex',
                                flexDirection:'column',
                                padding:'0',
                                overflow:'hidden'
                            }}>
                                <div style={{
                                    flex:1,
                                    overflowY:'auto',
                                    padding:'20px',
                                    background:'#f8f9fa'
                                }}>
                                    {chatLoading ? (
                                        <div style={{textAlign:'center',padding:'20px'}}>ë¡œë”©ì¤‘...</div>
                                    ) : chatMessages.length === 0 ? (
                                        <div style={{textAlign:'center',padding:'20px',color:'#999'}}>
                                            ì²« ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë³´ì„¸ìš”! ğŸ‘‹
                                        </div>
                                    ) : (
                                        <>
                                            {chatMessages.map(msg => (
                                                <div key={msg.id} style={{
                                                    marginBottom:'15px',
                                                    display:'flex',
                                                    flexDirection:'column',
                                                    alignItems:'flex-start'
                                                }}>
                                                    <div style={{
                                                        fontSize:'0.85rem',
                                                        color:'#666',
                                                        marginBottom:'4px'
                                                    }}>
                                                        <strong>{msg.nickname || 'ìµëª…'}</strong>
                                                        {' Â· '}
                                                        {new Date(msg.timestamp).toLocaleTimeString('ko-KR', {hour:'2-digit', minute:'2-digit'})}
                                                    </div>
                                                    <div style={{
                                                        background:'white',
                                                        padding:'10px 15px',
                                                        borderRadius:'12px',
                                                        maxWidth:'80%',
                                                        wordBreak:'break-word',
                                                        boxShadow:'0 1px 3px rgba(0,0,0,0.1)'
                                                    }}>
                                                        {msg.message}
                                                    </div>
                                                </div>
                                            ))}
                                            <div ref={chatEndRef} />
                                        </>
                                    )}
                                </div>
                                
                                <div style={{
                                    padding:'15px',
                                    background:'white',
                                    borderTop:'2px solid #e8e8e8',
                                    display:'flex',
                                    gap:'10px'
                                }}>
                                    <input 
                                        value={chatInput} 
                                        onChange={e=>setChatInput(e.target.value)}
                                        onKeyPress={e=>e.key==='Enter'&&sendChatMessage()}
                                        placeholder="ë©”ì‹œì§€ ì…ë ¥..."
                                        style={{
                                            flex:1,
                                            marginBottom:0,
                                            border:'2px solid #e8e8e8'
                                        }}
                                    />
                                    <button className="btn btn-small" onClick={sendChatMessage}>
                                        ì „ì†¡
                                    </button>
                                </div>
                            </div>
                        </div>
                    ) : tab === 'detector' ? (
                        <div className={`detector-container ${showImpact ? 'screen-shake' : ''}`}>
                            <div className="card" style={{
                                background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',
                                border: '3px solid #0f3460',
                                padding: '30px'
                            }}>
                                <h2 style={{
                                    textAlign: 'center',
                                    color: '#e94560',
                                    fontSize: '2rem',
                                    marginBottom: '10px',
                                    textShadow: '0 0 10px rgba(233, 69, 96, 0.5)'
                                }}>
                                    ğŸ” ê±°ì§“ë§ íƒì§€ê¸°
                                </h2>
                                <p style={{
                                    textAlign: 'center',
                                    color: '#aaa',
                                    marginBottom: '30px',
                                    fontSize: '0.9rem'
                                }}>
                                    AIê°€ ëƒ‰ì •í•˜ê³  ì”í˜¹í•˜ê²Œ ì§„ì‹¤ì„ íŒë‹¨í•©ë‹ˆë‹¤
                                </p>
                                
                                <textarea 
                                    value={detectorQuestion}
                                    onChange={e => setDetectorQuestion(e.target.value)}
                                    placeholder="ì§ˆë¬¸ì´ë‚˜ ì§„ìˆ ì„ ì…ë ¥í•˜ì„¸ìš”..."
                                    style={{
                                        minHeight: '120px',
                                        background: '#0f3460',
                                        border: '2px solid #533483',
                                        color: 'white',
                                        fontSize: '1.1rem'
                                    }}
                                    disabled={detectorLoading}
                                    maxLength={500}
                                />
                                
                                <div style={{
                                    textAlign: 'right',
                                    fontSize: '0.85rem',
                                    color: '#888',
                                    marginBottom: '15px'
                                }}>
                                    {detectorQuestion.length}/500
                                </div>
                                
                                <button 
                                    className="btn"
                                    onClick={detectLie}
                                    disabled={!detectorQuestion.trim() || detectorLoading}
                                    style={{
                                        background: detectorLoading 
                                            ? '#555' 
                                            : 'linear-gradient(135deg, #e94560 0%, #c62828 100%)',
                                        fontSize: '1.2rem',
                                        padding: '15px'
                                    }}
                                >
                                    {detectorLoading ? 'ë¶„ì„ ì¤‘...' : 'ğŸ” ì§„ì‹¤ íŒë³„'}
                                </button>
                            </div>
                            
                            {detectorLoading && (
                                <div className="detector-loading">
                                    <div className="heartbeat">ğŸ’“</div>
                                    <p style={{
                                        fontSize: '1.2rem',
                                        color: '#e94560',
                                        fontWeight: 'bold',
                                        marginTop: '20px'
                                    }}>
                                        ë¶„ì„ ì¤‘...
                                    </p>
                                </div>
                            )}
                            
                            {detectorResult && (
                                <div className={`detector-result ${
                                    detectorResult.verdict === 'ì§„ì‹¤' ? 'truth' : 
                                    detectorResult.verdict === 'ê±°ì§“' ? 'lie' : 'error'
                                }`}>
                                    <div className="verdict">
                                        {detectorResult.verdict === 'ì§„ì‹¤' && 'âœ… ì§„ì‹¤'}
                                        {detectorResult.verdict === 'ê±°ì§“' && 'âŒ ê±°ì§“'}
                                        {detectorResult.verdict === 'ì˜¤ë¥˜' && 'âš ï¸ ì˜¤ë¥˜'}
                                        {!['ì§„ì‹¤', 'ê±°ì§“', 'ì˜¤ë¥˜'].includes(detectorResult.verdict) && 'â“ íŒì • ë¶ˆê°€'}
                                    </div>
                                    <div className="reason">
                                        {detectorResult.reason}
                                    </div>
                                </div>
                            )}
                        </div>
                    ) : tab === 'ygosu' ? (
                        <div>
                            <div className="dcinside-info">
                                <h3 style={{marginBottom:'10px'}}>ğŸ® ì™€ì´ê³ ìˆ˜</h3>
                                <p style={{fontSize:'0.9rem',lineHeight:'1.6',color:'#856404'}}>
                                    âš ï¸ ë³´ì•ˆ ì •ì±…ìœ¼ë¡œ ì¸í•´ ì§ì ‘ embedê°€ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br/>
                                    iframeì´ í‘œì‹œë˜ì§€ ì•Šìœ¼ë©´ ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ ìƒˆ ì°½ì—ì„œ ì—´ì–´ì£¼ì„¸ìš”!
                                </p>
                            </div>
                            
                            <div className="card" style={{textAlign:'center',padding:'20px'}}>
                                <button 
                                    className="btn" 
                                    onClick={()=>window.open('https://ygosu.com/', '_blank')}
                                    style={{maxWidth:'400px',margin:'0 auto 20px'}}
                                >
                                    ğŸ”— ìƒˆ ì°½ì—ì„œ ì™€ì´ê³ ìˆ˜ ë³´ê¸°
                                </button>
                            </div>
                            
                            <div className="iframe-container">
                                <iframe 
                                    src="https://ygosu.com/"
                                    title="ì™€ì´ê³ ìˆ˜"
                                    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox allow-top-navigation"
                                    allow="autoplay; fullscreen; picture-in-picture"
                                />
                            </div>
                        </div>
                    ) : tab === 'fmkorea' ? (
                        <div>
                            <div className="dcinside-info">
                                <h3 style={{marginBottom:'10px'}}>âš½ í¨ì½” (ì—í¨ì½”ë¦¬ì•„)</h3>
                                <p style={{fontSize:'0.9rem',lineHeight:'1.6',color:'#856404'}}>
                                    âš ï¸ ë³´ì•ˆ ì •ì±…ìœ¼ë¡œ ì¸í•´ ì§ì ‘ embedê°€ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br/>
                                    iframeì´ í‘œì‹œë˜ì§€ ì•Šìœ¼ë©´ ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ ìƒˆ ì°½ì—ì„œ ì—´ì–´ì£¼ì„¸ìš”!
                                </p>
                            </div>
                            
                            <div className="card" style={{textAlign:'center',padding:'20px'}}>
                                <button 
                                    className="btn" 
                                    onClick={()=>window.open('https://www.fmkorea.com/', '_blank')}
                                    style={{maxWidth:'400px',margin:'0 auto 20px'}}
                                >
                                    ğŸ”— ìƒˆ ì°½ì—ì„œ í¨ì½” ë³´ê¸°
                                </button>
                            </div>
                            
                            <div className="iframe-container">
                                <iframe 
                                    src="https://www.fmkorea.com/"
                                    title="ì—í¨ì½”ë¦¬ì•„"
                                    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox allow-top-navigation"
                                    allow="autoplay; fullscreen; picture-in-picture"
                                />
                            </div>
                        </div>
                    ) : tab === 'guardian' ? (
                        <div>
                            <div className="card" style={{textAlign:'center',padding:'20px'}}>
                                <button 
                                    className="btn" 
                                    onClick={()=>window.open('https://www.theguardian.com/international', '_blank')}
                                    style={{maxWidth:'400px',margin:'0 auto 20px'}}
                                >
                                    ğŸ”— ìƒˆ ì°½ì—ì„œ ê°€ë””ì–¸ ë‰´ìŠ¤ ë³´ê¸°
                                </button>
                            </div>
                            
                            <div className="card" style={{
                                textAlign:'center',
                                padding:'60px 40px',
                                background:'linear-gradient(135deg, #ffeef8 0%, #ffe0f0 100%)',
                                border:'2px solid #ffb3d9',
                                borderRadius:'20px',
                                marginTop:'20px'
                            }}>
                                <h1 style={{
                                    fontSize:'3rem',
                                    marginBottom:'20px',
                                    background:'linear-gradient(135deg, #ff6b9d 0%, #c44569 100%)',
                                    WebkitBackgroundClip:'text',
                                    WebkitTextFillColor:'transparent',
                                    backgroundClip:'text'
                                }}>
                                    ì„ì›…ì´ì„ ìœ„í•œ ê³³
                                </h1>
                                <div style={{fontSize:'4rem',marginBottom:'20px'}}>â¤ï¸</div>
                                <p style={{
                                    fontSize:'1.3rem',
                                    color:'#c44569',
                                    fontWeight:'600',
                                    lineHeight:'1.8'
                                }}>
                                    ì–¸ì œë‚˜ ì‘ì›í•´! ğŸ’•
                                </p>
                            </div>
                        </div>
                    ) : null}
                </div>
            );
        }
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
