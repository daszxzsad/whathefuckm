<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´íŠ¸</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #f5f7fa; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 12px; margin-bottom: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .tab { flex: 1; min-width: 100px; padding: 15px; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; background: white; transition: all 0.3s; }
        .tab.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px; }
        input, textarea { width: 100%; padding: 12px; border: 2px solid #e8e8e8; border-radius: 8px; font-size: 1rem; margin-bottom: 10px; font-family: inherit; }
        textarea { min-height: 100px; resize: vertical; }
        .btn { padding: 14px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4); }
        .btn:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        .post { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px; }
        .post-header { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; color: #666; }
        .chat-container { height: 500px; overflow-y: auto; background: #f8f9fa; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .chat-message { background: white; padding: 12px; border-radius: 8px; margin-bottom: 10px; }
        .chat-header { font-weight: bold; color: #667eea; margin-bottom: 5px; font-size: 0.9rem; }
        .timer-box { background: rgba(255,255,255,0.2); padding: 20px; border-radius: 12px; text-align: center; margin: 20px 0; }
        .timer-text { font-size: 2rem; font-weight: bold; color: white; }
        .rank-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px; }
        .rank-item.me { background: #e3f2fd; border: 2px solid #2196f3; }
        .pvp-result { background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%); color: white; padding: 30px; border-radius: 12px; text-align: center; margin-bottom: 20px; }
        .pvp-result.lose { background: linear-gradient(135deg, #f44336 0%, #ef5350 100%); }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyC1sl588uhFIDvNdkp7xF-ERCnC_plUslw",
            authDomain: "anonymous-board-4a5a2.firebaseapp.com",
            databaseURL: "https://anonymous-board-4a5a2-default-rtdb.firebaseio.com",
            projectId: "anonymous-board-4a5a2",
            storageBucket: "anonymous-board-4a5a2.firebasestorage.app",
            messagingSenderId: "1088281214398",
            appId: "1:1088281214398:web:51e0fcea4dc66783bc7399"
        };
        
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.database();

        function App() {
            const [tab, setTab] = useState('board');
            
            // ê²Œì‹œíŒ
            const [posts, setPosts] = useState([]);
            const [postTitle, setPostTitle] = useState('');
            const [postContent, setPostContent] = useState('');
            
            // ì±„íŒ…
            const [chatMessages, setChatMessages] = useState([]);
            const [chatMessage, setChatMessage] = useState('');
            const [chatNickname, setChatNickname] = useState('');
            
            // ê³ ì¶”ë†ì¥
            const [farmUser, setFarmUser] = useState(null);
            const [farmNickname, setFarmNickname] = useState('');
            const [farmPassword, setFarmPassword] = useState('');
            const [isLogin, setIsLogin] = useState(true);
            const [farmUsers, setFarmUsers] = useState([]);
            const [remainingTime, setRemainingTime] = useState('');
            const [pvpTarget, setPvpTarget] = useState('');
            const [pvpAmount, setPvpAmount] = useState('');
            const [pvpRequests, setPvpRequests] = useState([]);
            const [pvpResult, setPvpResult] = useState(null);

            // ê²Œì‹œíŒ ë¦¬ìŠ¤ë„ˆ
            useEffect(() => {
                const ref = db.ref('posts').limitToLast(20);
                ref.on('value', snap => {
                    const data = snap.val();
                    if (data) {
                        const arr = Object.keys(data).map(k => ({id: k, ...data[k]})).sort((a,b) => b.timestamp - a.timestamp);
                        setPosts(arr);
                    }
                });
                return () => ref.off();
            }, []);

            // ì±„íŒ… ë¦¬ìŠ¤ë„ˆ  
            useEffect(() => {
                const ref = db.ref('chatMessages').limitToLast(100);
                ref.on('value', snap => {
                    const data = snap.val();
                    if (data) {
                        const arr = Object.keys(data).map(k => ({id: k, ...data[k]})).sort((a,b) => a.timestamp - b.timestamp);
                        setChatMessages(arr);
                    }
                });
                return () => ref.off();
            }, []);

            // ë†ì¥ ì‚¬ìš©ì ë¦¬ìŠ¤ë„ˆ
            useEffect(() => {
                const ref = db.ref('farmUsers');
                ref.on('value', snap => {
                    const data = snap.val();
                    if (data) {
                        const arr = Object.keys(data).map(k => ({id: k, ...data[k]})).sort((a,b) => b.length - a.length);
                        setFarmUsers(arr);
                        
                        const token = localStorage.getItem('farmToken');
                        if (token) {
                            const user = arr.find(u => u.id === token);
                            if (user) setFarmUser(user);
                        }
                    }
                });
                return () => ref.off();
            }, []);

            // PVP ìš”ì²­ ë¦¬ìŠ¤ë„ˆ
            useEffect(() => {
                const ref = db.ref('pvpRequests');
                ref.on('value', snap => {
                    const data = snap.val();
                    const token = localStorage.getItem('farmToken');
                    if (data && token) {
                        const arr = Object.keys(data).map(k => ({id: k, ...data[k]}))
                            .filter(r => r.status === 'pending' && (r.toId === token || r.fromId === token));
                        setPvpRequests(arr);
                    }
                });
                return () => ref.off();
            }, []);

            // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
            useEffect(() => {
                const updateTimer = () => {
                    if (!farmUser || !farmUser.lastCheckIn) {
                        setRemainingTime('ì¶œì„ ê°€ëŠ¥!');
                        return;
                    }
                    
                    const now = Date.now();
                    const passed = now - farmUser.lastCheckIn;
                    const cooldown = 24 * 60 * 60 * 1000;
                    
                    if (passed >= cooldown) {
                        setRemainingTime('ì¶œì„ ê°€ëŠ¥!');
                    } else {
                        const remaining = cooldown - passed;
                        const h = Math.floor(remaining / 3600000);
                        const m = Math.floor((remaining % 3600000) / 60000);
                        const s = Math.floor((remaining % 60000) / 1000);
                        setRemainingTime(`${h}ì‹œê°„ ${m}ë¶„ ${s}ì´ˆ`);
                    }
                };
                
                updateTimer();
                const interval = setInterval(updateTimer, 1000);
                return () => clearInterval(interval);
            }, [farmUser]);

            // ì±„íŒ… ë‹‰ë„¤ì„ ê°€ì ¸ì˜¤ê¸°
            useEffect(() => {
                let saved = localStorage.getItem('chatRandomNickname');
                if (!saved) {
                    const names = ['ì„ì›…', 'ëª…ì§„', 'ë¯¼ìˆ˜', 'ì¶©ì—°', 'ë¯¼ê¸°', 'ë¯¼í˜¸', 'ì‹ ìš°', 'ëŒ€ì›…'];
                    saved = names[Math.floor(Math.random() * names.length)];
                    localStorage.setItem('chatRandomNickname', saved);
                }
                setChatNickname(saved);
            }, []);

            // ê²Œì‹œê¸€ ì‘ì„±
            const createPost = () => {
                if (!postTitle.trim() || !postContent.trim()) return;
                db.ref('posts').push({
                    title: postTitle.trim(),
                    content: postContent.trim(),
                    timestamp: Date.now()
                });
                setPostTitle('');
                setPostContent('');
            };

            // ì±„íŒ… ì „ì†¡
            const sendChat = () => {
                if (!chatMessage.trim()) return;
                db.ref('chatMessages').push({
                    nickname: chatNickname,
                    message: chatMessage.trim(),
                    timestamp: Date.now()
                });
                setChatMessage('');
            };

            // ë†ì¥ íšŒì›ê°€ì…
            const farmRegister = () => {
                if (!farmNickname.trim() || !farmPassword.trim()) {
                    alert('ë‹‰ë„¤ì„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                    return;
                }
                if (farmPassword.length < 4) {
                    alert('ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒ!');
                    return;
                }
                const exists = farmUsers.find(u => u.nickname === farmNickname.trim());
                if (exists) {
                    alert('ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„!');
                    return;
                }
                
                const userId = btoa(farmNickname.trim() + Date.now());
                db.ref(`farmUsers/${userId}`).set({
                    nickname: farmNickname.trim(),
                    password: btoa(farmPassword),
                    length: 10,
                    lastCheckIn: 0,
                    createdAt: Date.now()
                });
                localStorage.setItem('farmToken', userId);
                alert('íšŒì›ê°€ì… ì™„ë£Œ! ğŸ‰');
            };

            // ë†ì¥ ë¡œê·¸ì¸
            const farmLogin = () => {
                if (!farmNickname.trim() || !farmPassword.trim()) {
                    alert('ë‹‰ë„¤ì„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                    return;
                }
                const user = farmUsers.find(u => u.nickname === farmNickname.trim());
                if (!user) {
                    alert('ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê³„ì •!');
                    return;
                }
                if (user.password !== btoa(farmPassword)) {
                    alert('ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼!');
                    return;
                }
                localStorage.setItem('farmToken', user.id);
                setFarmUser(user);
                alert('ë¡œê·¸ì¸ ì„±ê³µ! ğŸŒ¶ï¸');
            };

            // ë¡œê·¸ì•„ì›ƒ
            const farmLogout = () => {
                localStorage.removeItem('farmToken');
                setFarmUser(null);
            };

            // ì¶œì„ì²´í¬
            const checkIn = () => {
                const now = Date.now();
                if (!farmUser) return;
                
                if (farmUser.lastCheckIn && (now - farmUser.lastCheckIn) < 24 * 60 * 60 * 1000) {
                    const remaining = 24 * 60 * 60 * 1000 - (now - farmUser.lastCheckIn);
                    const h = Math.floor(remaining / 3600000);
                    const m = Math.floor((remaining % 3600000) / 60000);
                    alert(`ì•„ì§ ì¶œì„ ë¶ˆê°€! ${h}ì‹œê°„ ${m}ë¶„ í›„ ë‹¤ì‹œ!`);
                    return;
                }
                
                const growth = Math.floor(Math.random() * 100) + 1;
                const newLength = (farmUser.length || 10) + growth;
                
                db.ref(`farmUsers/${farmUser.id}`).update({
                    length: newLength,
                    lastCheckIn: now
                });
                
                db.ref('chatMessages').push({
                    nickname: 'ğŸŒ¶ï¸ ë†ì¥ ì‹œìŠ¤í…œ',
                    message: `${farmUser.nickname}ë‹˜ì´ ì¶œì„ì²´í¬ë¡œ ${growth}cm ì„±ì¥! (í˜„ì¬: ${newLength}cm)`,
                    timestamp: Date.now()
                });
                
                alert(`ğŸŒ¶ï¸ ${growth}cm ì„±ì¥! (í˜„ì¬: ${newLength}cm)`);
            };

            // PVP ì‹ ì²­
            const sendPvp = () => {
                if (!pvpTarget.trim() || !pvpAmount) return;
                if (!farmUser) return;
                
                const target = farmUsers.find(u => u.nickname === pvpTarget.trim());
                if (!target) {
                    alert('ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì!');
                    return;
                }
                if (target.id === farmUser.id) {
                    alert('ìì‹ ì—ê²ŒëŠ” ë¶ˆê°€!');
                    return;
                }
                
                const amount = parseInt(pvpAmount);
                if (amount <= 0 || isNaN(amount)) {
                    alert('ì˜¬ë°”ë¥¸ ìˆ«ì ì…ë ¥!');
                    return;
                }
                if (farmUser.length < amount) {
                    alert('ë³´ìœ  ê¸¸ì´ ë¶€ì¡±!');
                    return;
                }
                if (target.length < amount) {
                    alert('ìƒëŒ€ë°© ê¸¸ì´ ë¶€ì¡±!');
                    return;
                }
                
                db.ref('pvpRequests').push({
                    fromId: farmUser.id,
                    fromName: farmUser.nickname,
                    toId: target.id,
                    toName: target.nickname,
                    amount: amount,
                    status: 'pending',
                    timestamp: Date.now()
                });
                
                setPvpTarget('');
                setPvpAmount('');
                alert('PVP ì‹ ì²­ ì™„ë£Œ!');
            };

            // PVP ìˆ˜ë½
            const acceptPvp = (req) => {
                if (!farmUser) return;
                
                const iWin = Math.random() > 0.5;
                const winner = iWin ? farmUser.id : req.fromId;
                const loser = iWin ? req.fromId : farmUser.id;
                
                const winnerUser = farmUsers.find(u => u.id === winner);
                const loserUser = farmUsers.find(u => u.id === loser);
                
                if (!winnerUser || !loserUser) return;
                
                const updates = {};
                updates[`farmUsers/${winner}/length`] = winnerUser.length + req.amount;
                updates[`farmUsers/${loser}/length`] = Math.max(0, loserUser.length - req.amount);
                updates[`pvpRequests/${req.id}/status`] = 'completed';
                
                db.ref().update(updates);
                
                db.ref('chatMessages').push({
                    nickname: 'âš”ï¸ PVP ì‹œìŠ¤í…œ',
                    message: `${winnerUser.nickname}ë‹˜ì´ ${loserUser.nickname}ë‹˜ì„ ì´ê¹€! ${req.amount}cm íšë“!`,
                    timestamp: Date.now()
                });
                
                setPvpResult({
                    winner: winnerUser.nickname,
                    loser: loserUser.nickname,
                    amount: req.amount,
                    isMyWin: winner === farmUser.id
                });
                
                setTimeout(() => setPvpResult(null), 5000);
            };

            // PVP ê±°ì ˆ
            const rejectPvp = (reqId) => {
                db.ref(`pvpRequests/${reqId}`).update({ status: 'rejected' });
            };

            return (
                <div className="container">
                    <div className="header">
                        <h1>ğŸŒ¶ï¸ ì»¤ë®¤ë‹ˆí‹°</h1>
                    </div>
                    
                    <div className="tabs">
                        <button className={`tab ${tab==='board'?'active':''}`} onClick={()=>setTab('board')}>ğŸ“ ê²Œì‹œíŒ</button>
                        <button className={`tab ${tab==='chat'?'active':''}`} onClick={()=>setTab('chat')}>ğŸ’¬ ì±„íŒ…</button>
                        <button className={`tab ${tab==='farm'?'active':''}`} onClick={()=>setTab('farm')}>ğŸŒ¶ï¸ ê³ ì¶”ë†ì¥</button>
                    </div>
                    
                    {tab === 'board' && (
                        <div>
                            <div className="card">
                                <h3>ê²Œì‹œê¸€ ì‘ì„±</h3>
                                <input 
                                    type="text" 
                                    placeholder="ì œëª©" 
                                    value={postTitle}
                                    onChange={e=>setPostTitle(e.target.value)}
                                />
                                <textarea 
                                    placeholder="ë‚´ìš©"
                                    value={postContent}
                                    onChange={e=>setPostContent(e.target.value)}
                                />
                                <button className="btn" onClick={createPost}>ì‘ì„±í•˜ê¸°</button>
                            </div>
                            
                            {posts.map(post => (
                                <div key={post.id} className="post">
                                    <div className="post-header">
                                        <span>{new Date(post.timestamp).toLocaleString('ko-KR')}</span>
                                    </div>
                                    <h3 style={{marginBottom: '10px'}}>{post.title}</h3>
                                    <p style={{whiteSpace: 'pre-wrap'}}>{post.content}</p>
                                </div>
                            ))}
                        </div>
                    )}
                    
                    {tab === 'chat' && (
                        <div>
                            <div className="card" style={{background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: 'white'}}>
                                <h3>ë‹¹ì‹ ì˜ ë‹‰ë„¤ì„: {chatNickname} ğŸ²</h3>
                                <p style={{fontSize: '0.9rem', opacity: 0.9}}>(ìë™ ë°°ì •, ë³€ê²½ ë¶ˆê°€)</p>
                            </div>
                            
                            <div className="chat-container">
                                {chatMessages.map(msg => (
                                    <div key={msg.id} className="chat-message">
                                        <div className="chat-header">{msg.nickname} Â· {new Date(msg.timestamp).toLocaleTimeString('ko-KR')}</div>
                                        <div>{msg.message}</div>
                                    </div>
                                ))}
                            </div>
                            
                            <div style={{display: 'flex', gap: '10px'}}>
                                <input 
                                    type="text"
                                    placeholder="ë©”ì‹œì§€ ì…ë ¥"
                                    value={chatMessage}
                                    onChange={e=>setChatMessage(e.target.value)}
                                    onKeyPress={e=>e.key==='Enter'&&sendChat()}
                                    style={{marginBottom: 0}}
                                />
                                <button className="btn" onClick={sendChat}>ì „ì†¡</button>
                            </div>
                        </div>
                    )}
                    
                    {tab === 'farm' && (
                        <div>
                            {!farmUser ? (
                                <div className="card" style={{maxWidth: '500px', margin: '0 auto'}}>
                                    <h2 style={{textAlign: 'center', marginBottom: '20px'}}>
                                        ğŸŒ¶ï¸ ê³ ì¶”ë†ì¥ {isLogin ? 'ë¡œê·¸ì¸' : 'íšŒì›ê°€ì…'}
                                    </h2>
                                    <input 
                                        type="text"
                                        placeholder="ë‹‰ë„¤ì„"
                                        value={farmNickname}
                                        onChange={e=>setFarmNickname(e.target.value)}
                                    />
                                    <input 
                                        type="password"
                                        placeholder="ë¹„ë°€ë²ˆí˜¸ (4ì ì´ìƒ)"
                                        value={farmPassword}
                                        onChange={e=>setFarmPassword(e.target.value)}
                                        onKeyPress={e=>e.key==='Enter'&&(isLogin?farmLogin():farmRegister())}
                                    />
                                    <button 
                                        className="btn" 
                                        onClick={isLogin ? farmLogin : farmRegister}
                                        disabled={!farmNickname.trim() || !farmPassword.trim()}
                                    >
                                        {isLogin ? 'ğŸšª ë¡œê·¸ì¸' : 'ğŸŒ± íšŒì›ê°€ì…'}
                                    </button>
                                    <div style={{textAlign: 'center', marginTop: '15px'}}>
                                        <button
                                            onClick={()=>setIsLogin(!isLogin)}
                                            style={{background: 'none', border: 'none', color: '#667eea', cursor: 'pointer', textDecoration: 'underline'}}
                                        >
                                            {isLogin ? 'íšŒì›ê°€ì…í•˜ê¸°' : 'ë¡œê·¸ì¸í•˜ê¸°'}
                                        </button>
                                    </div>
                                </div>
                            ) : (
                                <div>
                                    {pvpResult && (
                                        <div className={`pvp-result ${pvpResult.isMyWin ? '' : 'lose'}`}>
                                            <h2 style={{fontSize: '2.5rem', marginBottom: '15px'}}>
                                                {pvpResult.isMyWin ? 'ğŸ‰ ìŠ¹ë¦¬!' : 'ğŸ˜¢ íŒ¨ë°°...'}
                                            </h2>
                                            <p style={{fontSize: '1.3rem'}}>
                                                {pvpResult.winner} vs {pvpResult.loser}
                                            </p>
                                            <p style={{fontSize: '1.1rem', marginTop: '10px'}}>
                                                {pvpResult.amount}cm ì´ë™!
                                            </p>
                                        </div>
                                    )}
                                    
                                    <div className="card" style={{background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: 'white'}}>
                                        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px'}}>
                                            <h2>{farmUser.nickname}ë‹˜ì˜ ë†ì¥</h2>
                                            <button 
                                                onClick={farmLogout}
                                                style={{background: 'rgba(255,255,255,0.2)', border: '1px solid white', color: 'white', padding: '5px 15px', borderRadius: '20px', cursor: 'pointer'}}
                                            >
                                                ğŸšª ë¡œê·¸ì•„ì›ƒ
                                            </button>
                                        </div>
                                        <div style={{fontSize: '3rem', textAlign: 'center', margin: '20px 0'}}>ğŸŒ¶ï¸</div>
                                        <div style={{fontSize: '2.5rem', fontWeight: 'bold', textAlign: 'center', marginBottom: '20px'}}>
                                            {farmUser.length}cm
                                        </div>
                                        
                                        <div className="timer-box">
                                            <div className="timer-text">â° {remainingTime}</div>
                                        </div>
                                        
                                        <button 
                                            className="btn"
                                            onClick={checkIn}
                                            disabled={remainingTime !== 'ì¶œì„ ê°€ëŠ¥!'}
                                            style={{
                                                width: '100%',
                                                background: remainingTime === 'ì¶œì„ ê°€ëŠ¥!' ? 'white' : 'rgba(255,255,255,0.3)',
                                                color: remainingTime === 'ì¶œì„ ê°€ëŠ¥!' ? '#667eea' : 'rgba(255,255,255,0.7)'
                                            }}
                                        >
                                            â­ ì¶œì„ì²´í¬ (1~100cm)
                                        </button>
                                    </div>
                                    
                                    {pvpRequests.length > 0 && (
                                        <div className="card">
                                            <h3 style={{marginBottom: '15px'}}>âš”ï¸ PVP ìš”ì²­</h3>
                                            {pvpRequests.map(req => {
                                                const isReceived = req.toId === farmUser.id;
                                                return (
                                                    <div key={req.id} style={{padding: '15px', background: '#f8f9fa', borderRadius: '8px', marginBottom: '10px'}}>
                                                        {isReceived ? (
                                                            <>
                                                                <div style={{marginBottom: '10px', fontWeight: 'bold'}}>
                                                                    {req.fromName}ë‹˜ì´ {req.amount}cmë¥¼ ê±¸ê³  ë„ì „!
                                                                </div>
                                                                <div style={{display: 'flex', gap: '10px'}}>
                                                                    <button 
                                                                        className="btn"
                                                                        onClick={()=>acceptPvp(req)}
                                                                        style={{flex: 1, background: 'linear-gradient(135deg, #4caf50 0%, #66bb6a 100%)'}}
                                                                    >
                                                                        âœ… ìˆ˜ë½
                                                                    </button>
                                                                    <button 
                                                                        className="btn"
                                                                        onClick={()=>rejectPvp(req.id)}
                                                                        style={{flex: 1, background: 'linear-gradient(135deg, #f44336 0%, #ef5350 100%)'}}
                                                                    >
                                                                        âŒ ê±°ì ˆ
                                                                    </button>
                                                                </div>
                                                            </>
                                                        ) : (
                                                            <div style={{color: '#666'}}>
                                                                {req.toName}ë‹˜ì—ê²Œ {req.amount}cm ë„ì „ ëŒ€ê¸° ì¤‘...
                                                            </div>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    )}
                                    
                                    <div className="card">
                                        <h3 style={{marginBottom: '15px'}}>âš”ï¸ PVP ë„ì „í•˜ê¸°</h3>
                                        <input 
                                            type="text"
                                            placeholder="ìƒëŒ€ë°© ë‹‰ë„¤ì„"
                                            value={pvpTarget}
                                            onChange={e=>setPvpTarget(e.target.value)}
                                        />
                                        <input 
                                            type="number"
                                            placeholder="ê±¸ cm"
                                            value={pvpAmount}
                                            onChange={e=>setPvpAmount(e.target.value)}
                                        />
                                        <button 
                                            className="btn"
                                            onClick={sendPvp}
                                            disabled={!pvpTarget.trim() || !pvpAmount}
                                        >
                                            âš”ï¸ PVP ì‹ ì²­
                                        </button>
                                    </div>
                                    
                                    <div className="card">
                                        <h3 style={{marginBottom: '15px'}}>ğŸ† ë­í‚¹</h3>
                                        {farmUsers.map((user, idx) => (
                                            <div key={user.id} className={`rank-item ${user.id === farmUser.id ? 'me' : ''}`}>
                                                <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}>
                                                    <span style={{
                                                        fontSize: '1.5rem',
                                                        fontWeight: 'bold',
                                                        color: idx === 0 ? '#ffd700' : idx === 1 ? '#c0c0c0' : idx === 2 ? '#cd7f32' : '#999'
                                                    }}>
                                                        {idx + 1}
                                                    </span>
                                                    <span style={{fontWeight: 'bold'}}>{user.nickname}</span>
                                                    {user.id === farmUser.id && (
                                                        <span style={{background: '#2196f3', color: 'white', padding: '2px 8px', borderRadius: '4px', fontSize: '0.8rem'}}>
                                                            ë‚˜
                                                        </span>
                                                    )}
                                                </div>
                                                <div style={{fontSize: '1.2rem', fontWeight: 'bold', color: '#4caf50'}}>
                                                    ğŸŒ¶ï¸ {user.length}cm
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
